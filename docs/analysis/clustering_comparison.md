# 两种聚类方法的差异分析报告

## 聚类方法说明

### 1. Epitope Clustering (表位聚类)
- **文件**: `data/cluster/epitope_cluster_summary.csv`
- **依据**: 表位的结构相似性 (RMSD ≤ 2.5Å) + 序列相似性 (Identity ≥ 40%)
- **含义**: 同一簇内的表位在结构和序列上相似
- **目的**: 去冗余，找出结构多样性
- **详情**: [docs/scripts/10_cluster_epitopes.md](../scripts/10_cluster_epitopes.md)

### 2. Antibody Clustering (抗体聚类)
- **文件**: `data/cluster/antibody_cluster_summary.csv`
- **依据**: 相同抗体 (H/L链序列相同)
- **含义**: 同一簇内的记录使用相同的抗体
- **目的**: 研究同一抗体对不同抗原的识别能力
- **详情**: [docs/scripts/10_cluster_by_same_antibody.md](../scripts/10_cluster_by_same_antibody.md)

## 基本统计

| 指标 | Epitope Clustering | Antibody Clustering |
|------|-------------------|---------------------|
| 总记录数 | 3537 | 3537 |
| 聚类数量 | 2895 | 2456 |
| Singleton 数量 | 2558 (88.4%) | 2001 (81.5%) |
| 非 Singleton 聚类 | 337 | 455 |
| 最大簇大小 | 38 | 78 |
| 平均簇大小 | 1.22 | 1.44 |

**观察**: Antibody clustering 产生了更少但更大的簇，说明同一抗体识别多个不同抗原的情况相当常见。

## 核心差异分析

### 记录归属对比 (基于邻居关系)

| 情况 | 数量 | 占比 | 含义 |
|------|------|------|------|
| 两边都是 Singleton | 1785 | 52.9% | 独特的抗体-表位组合 |
| 只在 Epitope clustering 有邻居 | 137 | 4.1% | 结构相似的表位被不同抗体识别 |
| 只在 Antibody clustering 有邻居 | 893 | 26.5% | 同一抗体识别结构不同的表位 |
| 两边都有邻居且完全相同 | 78 | 2.3% | 两种聚类结果完全一致 |
| 两边都有邻居但不完全相同 | 483 | 14.3% | 两种聚类结果部分重叠 |

### 关键数字

- **405** 个 antibody clusters 包含 2+ 个不同的 epitope clusters
- **94** 个 epitope clusters 分散在 2+ 个不同的 antibody clusters 中

## 生物学解读

### 1. 只在 Antibody clustering 有邻居 (26.5%)

这些记录表示: **同一抗体识别的表位在结构上并不相似**。

- **可能原因 A**: 抗体具有一定的交叉反应性（polyspecificity）
- **可能原因 B**: 不同抗原上存在构象相似但序列不同的表位
- **可能原因 C**: 抗体的 CDR 区域具有一定的灵活性，可适应不同形状的表位

### 2. 只在 Epitope clustering 有邻居 (4.1%)

这些记录表示: **结构相似的表位被不同的抗体识别**。

- **生物学意义**: 这些表位可能是常见的免疫原性热点区域
- **应用价值**: 多个不同抗体都能识别相似结构，说明这是潜在的通用疫苗靶点
- **注意**: 这种情况相对较少，说明抗体识别具有较高的特异性

### 3. 两边都有邻居但不同 (14.3%)

这种情况说明:
- 结构相似性和抗体特异性是两个**独立的维度**
- 单一维度的聚类无法完整描述抗体-抗原相互作用的复杂性

## 高多样性案例

### Antibody clusters 内部表位多样性最高的案例

| Antibody Cluster | 大小 | 不同 Epitope Clusters 数 | 代表性 PDB |
|-----------------|------|-------------------------|------------|
| 500 | 39 | 24 | 7wgt, 4xp4, 4xp9 |
| 353 | 46 | 16 | 7udh, 7ubr, 3t3p |
| 1451 | 78 | 15 | 2ih3, 1r3j, 2hvk |
| 728 | 14 | 14 | 8bcz, 7nx8, 7nx6 |
| 1610 | 15 | 13 | 6xc4, 7kn6, 9cpu |

这些代表了"**广谱抗体**"，能够识别结构差异较大的多种表位。

### Epitope clusters 分散最广的案例

| Epitope Cluster | 大小 | 分布在多少 Antibody Clusters | 代表性 PDB |
|-----------------|------|----------------------------|------------|
| 1221 | 27 | 18 | 6xc2, 7bem, 7e8f |

这可能代表了一个**免疫优势表位**，多个不同的抗体都倾向于识别它。

## 结论

1. **两种聚类方法捕获的是不同的生物学信息**:
   - Epitope clustering → 结构/序列相似性
   - Antibody clustering → 抗体识别特异性

2. **差异程度**: 约 45% 的记录在两种聚类中有不同的归属（排除两边都是 singleton 的情况）

3. **建议**:
   - 如果目标是**去冗余训练数据**：使用 Epitope clustering
   - 如果目标是**研究抗体交叉反应性**：使用 Antibody clustering
   - 如果需要**全面分析**：可以考虑两种聚类的交集或并集

---
*分析日期: 2025-12-03*
