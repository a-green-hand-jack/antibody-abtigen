# 人源-鼠源抗原结构对数据库构建指南

## 概述

本指南深入解析构建"鼠源-人源抗原结构对"数据库的底层逻辑与技术实现，为结构生物学家、抗体工程师及生物信息学家提供详尽的实战指南。

### 核心挑战

在抗体药物研发中，抗体对临床前毒理学研究模型（尤其是小鼠）靶点蛋白的交叉反应性是决定候选药物能否顺利进入临床试验的关键门槛。然而：

- **序列同源性 ≠ 结构表位一致性**：微小的序列变异，尤其是位于溶剂可及表面的侧链突变，足以改变电荷分布、疏水性斑块或引入位阻，导致抗体结合亲和力剧烈下降
- **完整复合物的必要性**：蛋白质在生理环境下极少以孤立单体形式执行功能，四级结构的组装状态对抗原表位的呈现具有决定性影响
- **数据碎片化**：PDB有结构无同源关系，UniProt有同源关系无结构，SAbDab关注抗体而非抗原对

## 核心数据资源

### 1. 实验结构数据库

#### 1.1 RCSB PDB

**关键要点**：
- PDB体系已全面转向PDBx/mmCIF格式（传统PDB格式最多支持99,999个原子）
- 许多大型抗原复合物（如病毒糖蛋白三聚体、核糖体复合物）仅能通过mmCIF格式获取
- 在自动化脚本中必须使用支持mmCIF解析的库（如BioPython的MMCIFParser）

**技术实现**：
```python
from Bio.PDB import MMCIFParser

parser = MMCIFParser()
structure = parser.get_structure('complex', 'structure.cif')
```

#### 1.2 QSbio（生物组装体校正）

**核心价值**：
- 整合PISA和EPPIC算法，对PDB中的多聚体状态进行系统性置信度评估与修正
- 过滤晶体学伪影，确保对比的是生理状态下的抗原结构
- 即使是高度保守的直系同源蛋白，其四级结构界面也可能表现出"可塑性"

**数据获取策略**：
- 优先检索QSbio提供的校正后的生物组装体文件
- 查阅`pdbx_struct_assembly`字段，优先选择被QSbio标记为"High Confidence"的组装体

#### 1.3 SAbDab（抗体-抗原复合物专用资源）

**数据架构**：
- 经过深度注释和结构化处理的抗体专用数据库
- 自动识别PDB文件中的抗体链（重链、轻链）与抗原链
- Thera-SAbDab子库专门收录治疗性抗体的结构数据

**应用策略**：
- 通过关键词或UniProt ID分别检索"Human Antibody - Human Antigen"与"Human Antibody - Mouse Antigen"复合物
- 通过链ID精确提取抗原部分，实现自动化构建"抗原对"

### 2. 序列与直系同源映射

#### 2.1 UniProtKB

**参考蛋白质组**：
- Human: `UP000005640`
- Mouse: `UP000000589`

**ID Mapping API**：
```python
import requests

def uniprot_id_mapping(uniprot_ids, from_db='UniProtKB_AC-ID', to_db='PDB'):
    """将UniProt ID映射到PDB ID"""
    url = 'https://rest.uniprot.org/idmapping/run'
    data = {
        'from': from_db,
        'to': to_db,
        'ids': ','.join(uniprot_ids)
    }
    response = requests.post(url, data=data)
    return response.json()
```

#### 2.2 Ensembl Compara

**核心功能**：
- 通过构建基因树推断同源关系
- 提供高精度的直系同源列表

**Python实现**：
```python
import requests

def get_mouse_ortholog(human_gene_id: str) -> dict:
    """获取人源基因的鼠源直系同源基因"""
    server = "https://rest.ensembl.org"
    ext = f"/homology/id/{human_gene_id}?target_species=mouse;type=orthologues"
    r = requests.get(
        server + ext,
        headers={"Content-Type": "application/json"}
    )

    if not r.ok:
        return None

    decoded = r.json()
    # 解析返回的JSON，提取target_id和%id
    # 需处理1-to-many的情况，选择置信度最高的条目
    return parse_ortholog_data(decoded)
```

**注意事项**：
- 理想情况是"1-to-1"同源
- 在免疫球蛋白超家族或酶家族中，常出现"1-to-many"或"many-to-many"的情况
- 需结合序列一致性（% Identity）和覆盖度（% Coverage）进行筛选

#### 2.3 其他同源资源

- **NCBI HomoloGene**：提供直观的同源群（HID）系统，适合快速构建基准数据集
- **OrthoMaM**：基于系统发育校正的哺乳动物直系同源标记，有助于排除旁系同源的干扰
- **ECOD**：基于结构域的进化关系分类，当序列相似性较低时，可识别共享的结构域拓扑

### 3. 预计算模型数据库

#### 3.1 AlphaFold DB

**局限性**：
- 主要提供单链（Monomer）预测结构
- 对于需要复合物信息的抗原，需自行运行AlphaFold-Multimer

**置信度评估**：
- **pLDDT**：预测置信度分数
- **PAE矩阵**：判断结构差异是否源于预测误差的关键指标
  - 如果两个物种在某区域的结构差异很大，但该区域的pLDDT值极低，则这种差异很可能是由于无序区预测的不确定性造成的

#### 3.2 SWISS-MODEL Repository (SMR)

**独特价值**：
- 如果一个小鼠蛋白在SMR中的模型是基于人类PDB结构模建的，那么这个模型天然就与人类结构处于同一构象空间
- 相当于SMR已经替用户完成了一次"结构对齐"

## 虚拟数据库构建策略

### 数据模型设计

一个理想的鼠源-人源抗原结构对条目应包含以下核心字段：

| 字段 | 描述 |
|------|------|
| Pair ID | 唯一标识符（如 Human_UniProt_ID + Mouse_UniProt_ID） |
| Orthology Score | 来自Ensembl或HomoloGene的同源置信度及序列一致性百分比 |
| Human Structure | 最佳实验结构（PDB ID + Assembly ID）或高置信度AI模型 |
| Mouse Structure | 对应的实验结构或同源模型 |
| Complex State | 描述生物组装体状态（如 Homodimer, Heterotrimer） |
| Alignment Metrics | 结构叠合后的全局RMSD、界面RMSD、关键表位区域的序列/结构差异列表 |

### 关键工具选型

#### H2M (Human-to-Mouse) Pipeline

**核心功能**：
- 将人类遗传变异映射到小鼠直系同源基因上
- 整合ClinVar等变异数据库，评估特定的人源突变在小鼠背景下是否"致病"

**在抗原分析中的应用**：
- 自动识别在人类中保守但在小鼠中发生突变的关键残基
- 这些残基往往就是导致交叉反应失败的根源

#### Homolmapper

**核心功能**：
- 将序列同源性信息可视化映射到蛋白质三维结构上
- 将序列保守性分数转化为B因子或颜色代码，直接涂染在PDB结构上

**应用策略**：
- 生成的结构文件可直观展示"鼠源-人源"差异热点（Hotspots）
- 抗体工程师可直接观察结构表面的颜色变化，快速判断目标表位是否位于高度变异区

### 数据集划分与基准测试

**拆分逻辑**：
- 依据序列相似性进行训练集/测试集的严格划分（如使用CD-HIT聚类，阈值设为30%或40%）
- 防止数据泄漏

**基准指标**：
- 引入AbRank等基准测试框架
- 评估模型在预测抗体-抗原亲和力及交叉反应性方面的准确性
- 特别关注"困难案例"：序列差异微小但结构构象差异巨大的抗原对

## 完整抗原复合物的获取策略

### 策略一：基于PDB生物组装体的深度挖掘

**适用场景**：已有实验数据的抗原

**技术实现路径**：
1. **UniProt-to-PDB Mapping**：利用UniProt API获取所有人源和鼠源抗原的PDB链ID
2. **筛选生物组装体**：查阅`pdbx_struct_assembly`字段，优先选择被QSbio标记为"High Confidence"的组装体
3. **下载与清洗**：使用BioPython的`retrieve_assembly_file`方法下载
   - **注意**：必须处理`.cif`格式，因为许多复合物没有对应的`.pdb`文件

**代码示例**：
```python
from Bio.PDB import PDBList

pdb_list = PDBList()
# 下载生物组装体（注意：需要使用.cif格式）
pdb_list.retrieve_assembly_file('1ABC', file_format='mmCIF', assembly_id=1)
```

### 策略二：基于人源模板的同源模建

**适用场景**：只有人源结构（Template）而无鼠源结构（Target）时

**优势**：由于人鼠同源性通常较高（>80%），这种方法的精度极高

#### SWISS-MODEL模式

通过API提交鼠源序列，指定Template ID为人源PDB结构。SMR会自动处理Loop区的补全和侧链的重排。

#### MODELLER多链模建

对于复合物（如异源二聚体），MODELLER提供了更精细的控制。

**代码示例**：
```python
from modeller import *
from modeller.automodel import *

env = environ()
env.io.atom_files_directory = ['./pdb_structures/']

# 定义多链模建类
class MyModel(AutoModel):
    def special_restraints(self, aln):
        # 施加对称性约束，确保Chain A和Chain B构象一致
        s1 = Selection(self.chains['A'])
        s2 = Selection(self.chains['B'])
        self.restraints.symmetry.append(Symmetry(s1, s2, 1.0))

# 准备比对文件 alignment.ali，其中序列包含 "/" 分隔符
# 运行模建
a = MyModel(
    env,
    alnfile='human_mouse_align.ali',
    knowns='Human_Complex_PDB',
    sequence='Mouse_Complex_Target'
)
a.starting_model = 1
a.ending_model = 5
a.make()
```

**关键要点**：
- 需在Alignment文件（`.ali`）中用`/`符号分隔不同的链
- 对于同源多聚体，需添加对称性约束，强制不同亚基保持相同的构象
- 生成的鼠源模型天然叠合在人源模板的坐标系中，简化后续差异分析

### 策略三：基于AI的从头预测与复合物组装

**适用场景**：人鼠双方均无实验结构，或需要预测抗原与抗体复合物的情况

#### AlphaFold-Multimer

**核心机制**：
- 通过Cross-chain attention机制在折叠过程中同时优化多条链的相互作用
- 并非简单的单体对接

**实战应用**：
- 推荐使用ColabFold（基于MMseqs2加速MSA生成）进行批量预测
- 通过编写Shell脚本（`colabfold_batch`），可以一次性提交数百个鼠源复合物序列

**置信度评估**：
- 必须利用PAE Viewer等工具分析预测结果
- 只有当亚基间的PAE值较低（通常<10Å，显示为深蓝色）时，才表明复合物界面是可靠的
- 如果亚基内部PAE低但亚基间PAE高，说明模型虽然折叠好了单体，但并未找到确定的结合模式

#### ESMFold

**优势**：
- 基于蛋白质语言模型，推理速度比AlphaFold快一个数量级（~60倍）

**策略**：
- 利用ESMFold快速生成全蛋白质组级的鼠源-人源复合物"草图"
- 虽然精度略低于AlphaFold，但足以用于初步筛选潜在的结构差异显著的靶点
- 随后再对核心靶点使用AlphaFold-Multimer进行精修

## 自动化管线架构

### 模块设计

| 模块名称 | 功能描述 | 核心依赖库 | 输入/输出 |
|---------|---------|-----------|----------|
| Ortholog Mapper | 获取人鼠同源基因ID及序列 | requests (Ensembl API), pandas | Input: Gene Symbol<br>Output: UniProt IDs (Hu/Mo) |
| Structure Miner | 检索PDB/AlphaFold DB | biopython.Bio.PDB, rcsbsearchapi | Input: UniProt IDs<br>Output: .cif / .pdb files |
| Complex Builder | 缺失结构模建与组装 | modeller, colabfold_batch | Input: Sequences<br>Output: Homology Models |
| Align & Analyze | 结构叠合、RMSD计算、差异映射 | pymol-bundle, numpy | Input: Structure Pairs<br>Output: RMSD Report, Residue Lists |

### 关键功能模块实现

#### 结构检索与下载模块

**代码逻辑**：
- 检查RCSB Search API返回的`rcsb_entry_info.assembly_count`
- 若大于0，则构造URL `https://files.rcsb.org/download/{pdb_code}.pdb1.gz` 进行下载
- BioPython的PDBList类在较新版本中通过`retrieve_assembly_file`方法支持此功能

#### 结构叠合与差异分析模块

**实现方式**：利用PyMOL的Python API进行自动化分析

**核心功能**：
1. **叠合逻辑**：使用`cmd.align(mobile, target)`将鼠源结构对齐到人源结构
2. **RMSD计算**：
   - 计算全局RMSD
   - 更重要的是计算"Per-residue RMSD"
3. **界面分析**：
   - 提取人源结构中距离抗体（如果有）或配体5Å以内的残基集合
   - 对比该集合在鼠源结构中的对应残基
   - 计算序列一致性和结构偏差
   - 直接识别出导致交叉反应失败的"罪魁祸首"

## 深度分析：从数据到抗体工程的洞察

### 界面保守性与"空隙填充"效应

**核心发现**：
- 即使整体RMSD很低（<1.0Å），界面处的单个氨基酸突变（如大侧链变小侧链）也可能产生"空隙"（Void），导致结合能显著降低
- 反之，小侧链变大侧链可能产生位阻

**应用策略**：
- 在设计交叉反应抗体时，应避免靶向那些包含"空隙填充"类突变的区域
- H2M管线和Homolmapper的可视化能帮助快速识别这些区域

### 糖基化位点的种属差异

**核心问题**：
- 小鼠和人类蛋白的N-糖基化位点（N-X-S/T motif）往往不保守
- 许多晶体结构和AlphaFold模型缺乏糖链
- 如果在人源抗原的表位区域存在一个鼠源中缺失的糖基化位点，那么在小鼠模型中筛选出的抗体可能在人体内被糖链"屏蔽"而失效

**解决方案**：
- 在自动化管线中，必须集成UniProt的PTM（翻译后修饰）注释
- 在结构模型上标记潜在的糖基化位点，作为抗体设计的"禁区"

### 构象动态性的影响

**核心观点**：
- 静态结构无法完全反映蛋白质的"呼吸"
- 人鼠序列差异可能导致Loop区的动力学性质（B-factor）改变

**进阶策略**：
- 对于关键靶点，建议对构建的鼠源/人源模型进行简短的分子动力学（MD）模拟
- 对比两者的构象系综（Conformational Ensemble）
- 如果鼠源蛋白的某个Loop摆动幅度显著大于人源，即使静态结构相似，抗体结合熵损失（Entropy Loss）的差异也可能导致亲和力下降

## 实施路线图

### Level 1（基础）

**目标**：利用现有资源建立已解析结构的靶点清单

**步骤**：
1. 利用SAbDab和UniProt ID Mapping
2. 建立已解析结构的靶点清单
3. 进行直接对比

### Level 2（进阶）

**目标**：针对核心靶点进行小鼠直系同源蛋白的复合物预测

**步骤**：
1. 部署ColabFold/AlphaFold-Multimer
2. 针对核心靶点进行小鼠直系同源蛋白的复合物预测
3. 利用QSbio标准进行验证

### Level 3（高阶）

**目标**：构建自动化分析平台，集成序列-结构-功能映射

**步骤**：
1. 构建基于H2M和Homolmapper的自动化分析平台
2. 集成序列-结构-功能映射
3. 在抗体筛选的最早期排除潜在的种属特异性表位

## 关键数据资源与工具列表

### 基础数据库

| 名称 | 核心功能 | 关键引用 |
|------|---------|---------|
| RCSB PDB | 全球生物大分子结构归档，支持API检索 | [8] |
| UniProt | 蛋白序列、功能注释及ID映射 | [50] |
| Ensembl | 基因组数据，提供高精度直系同源映射 | [20] |

### 结构分析库

| 名称 | 核心功能 | 关键引用 |
|------|---------|---------|
| QSbio | 蛋白质四级结构（生物组装体）置信度评估 | [7] |
| SAbDab | 结构化抗体-抗原复合物数据库 | [11] |
| ECOD | 蛋白质结构域进化分类 | [24] |

### 预测与模建

| 名称 | 核心功能 | 关键引用 |
|------|---------|---------|
| AlphaFold DB | 全蛋白质组AI预测结构库（含小鼠/人类） | [26] |
| SWISS-MODEL | 自动化同源模建服务器 | [30] |

### 工具软件

| 名称 | 核心功能 | 关键引用 |
|------|---------|---------|
| H2M | 人-鼠遗传变异与功能映射管线 | [32] |
| Homolmapper | 将同源性信息映射至3D结构的可视化工具 | [34] |
| BioPython | Python生物信息学核心库（PDB解析/下载） | [9] |
| PyMOL | 结构可视化与自动化分析脚本接口 | [48] |

## 总结

构建"鼠源-人源抗原结构对"数据库并非单一的数据下载任务，而是一个涉及多源数据整合、结构生物学验证及计算建模的系统工程。

**核心要点**：
1. **现有资源整合**：通过整合UniProt（同源关系）、RCSB PDB/QSbio（生物组装体）、SAbDab（抗体复合物），可以构建出高质量的基础数据集
2. **AI填补空白**：AlphaFold-Multimer和ESMFold彻底改变了缺乏实验结构的困境，使得全蛋白质组级的复合物结构对比成为可能
3. **自动化是关键**：利用Python脚本（BioPython, Modeller, PyMOL API）串联各个环节，是实现高通量分析的唯一路径

通过这一系统化的策略，研究人员可以最大程度地降低因种属差异导致的药物研发风险，确保临床前模型数据的临床转化价值。

---

## 参考文献

详细的参考文献列表请参考原始文档末尾的引用部分。
